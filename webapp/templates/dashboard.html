{% extends "base.html" %}

{% block title %}Tableau de bord Admin - Kaymay Services{% endblock %}

{% block extra_css %}
<style>
    /* Styles spécifiques au dashboard admin */
    .admin-container {
        padding: 20px;
        margin-top: 30px;
    }

    .admin-sidebar {
        background: #343a40;
        min-height: calc(100vh - 70px);
        padding: 0;
        color: white;
    }

    .admin-sidebar .nav-link {
        color: rgba(255, 255, 255, 0.8);
        border-left: 3px solid transparent;
        padding: 12px 20px;
    }

    .admin-sidebar .nav-link:hover,
    .admin-sidebar .nav-link.active {
        background: rgba(255, 255, 255, 0.1);
        color: white;
        border-left: 3px solid #007bff;
    }

    .admin-sidebar .nav-link i {
        margin-right: 10px;
        width: 20px;
        text-align: center;
    }

    .admin-content {
        background: #f8f9fa;
        padding: 30px;
        border-radius: 5px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }

    .stat-card {
        border-radius: 5px;
        padding: 20px;
        margin-bottom: 20px;
        color: white;
        text-align: center;
        transition: transform 0.3s;
    }

    .stat-card:hover {
        transform: translateY(-5px);
    }

    .stat-card i {
        font-size: 2rem;
        margin-bottom: 10px;
    }

    .stat-card .count {
        font-size: 1.8rem;
        font-weight: bold;
    }

    .stat-card .label {
        font-size: 0.9rem;
        opacity: 0.8;
    }

    .card-1 {
        background: linear-gradient(45deg, #007bff, #00b4ff);
    }

    .card-2 {
        background: linear-gradient(45deg, #28a745, #5cb85c);
    }

    .card-3 {
        background: linear-gradient(45deg, #ffc107, #ffd700);
    }

    .card-4 {
        background: linear-gradient(45deg, #dc3545, #ff6b6b);
    }
</style>
{% endblock %}

{% block content %}
<div class="admin-container">
    <div class="row">
        <!-- Sidebar -->
        <div class="col-md-3">
            <div class="admin-sidebar">
                <div class="sidebar-header p-3">
                    <h5 class="text-center">Administration</h5>
                    <hr class="bg-light">
                </div>
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link active" href="{{ url_for('views.dashboard') }}">
                            <i class="fa fa-tachometer"></i> Tableau de bord
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="fa fa-newspaper-o"></i> Articles du blog
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('views.realisations') }}">
                            <i class="fa fa-photo"></i> Réalisations
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('views.configuration') }}">
                            <i class="fa fa-cogs"></i> Configuration
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('views.contact') }}">
                            <i class="fa fa-comments"></i> Commentaires
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="">
                            <i class="fa fa-users"></i> Utilisateurs
                        </a>
                    </li>
                    <li class="nav-item mt-4">
                        <a class="nav-link" href="{{ url_for('auth.logout') }}">
                            <i class="fa fa-sign-out"></i> Déconnexion
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Main Content -->
        <div class="col-md-9">
            <div class="admin-content">
                <h2><i class="fa fa-tachometer"></i> Tableau de bord</h2>
                <hr>

                <!-- Statistiques -->
                <div class="row">
                    <div class="col-md-3">
                        <div class="stat-card card-1">
                            <i class="fa fa-newspaper-o"></i>
                            <div class="count">{#{ stats.posts }#}</div>
                            <div class="label">Articles</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card card-2">
                            <i class="fa fa-photo"></i>
                            <div class="count">{#{ stats.realisations }#}</div>
                            <div class="label">Réalisations</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card card-3">
                            <i class="fa fa-comments"></i>
                            <div class="count">{#{ stats.comments }#}</div>
                            <div class="label">Commentaires</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card card-4">
                            <i class="fa fa-users"></i>
                            <div class="count">{#{ stats.users }#}</div>
                            <div class="label">Utilisateurs</div>
                        </div>
                    </div>
                </div>

                <!-- Derniers articles -->
                <div class="mt-5">
                    <div class="row py-3">
                        <div class="col">
                            <h4><i class="fa fa-clock-o"></i> Derniers articles</h4>
                        </div>
                        <div class="col">
                            <a href="{{url_for('views.new_blog')}}" class="btn btn-outline-primary">Nouveau blog</a>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead class="thead-light">
                                <tr>
                                    <th>Titre</th>
                                    <th>Auteur</th>
                                    <th>Date</th>
                                    <th>Vues</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for post in stats.recent_posts %}
                                <tr>
                                    <td>{{ post.titre }}</td>
                                    <td>{{ post.auteur }}</td>
                                    <td>{{ post.date_posted.strftime('%d/%m/%Y') }}</td>
                                    <td>{{ post.soustitre }}</td>
                                    <td>
                                        <a href="{{url_for('views.detail', id_post=post.id)}}"
                                            class="btn btn-sm btn-primary">
                                            <i class="fa fa-eye"></i>
                                        </a>
                                        <a href="{{url_for('views.update_post', id_post=post.id)}}" 
                                        class="btn btn-sm btn-warning"> <i class="fa fa-edit"></i> </a>

                                        <a href="{{url_for('views.delete_post', id_post=post.id)}}" 
                                        class="btn btn-sm btn-danger"> <i class="fa fa-trash"></i> </a>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <a href="{#{ url_for('views.posts') #}}" class="btn btn-outline-primary mt-2">
                        Voir tous les articles <i class="fa fa-arrow-right"></i>
                    </a>
                </div>

                <!-- Activité récente -->
                <div class="mt-5">
                    <h4><i class="fa fa-history"></i> Activité récente</h4>
                    <div class="list-group">
                        {% for activity in recent_activity %}
                        <div class="list-group-item list-group-item-action">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <i class="fa fa-{{ activity.icon }} mr-2 text-primary"></i>
                                    <span>{{ activity.description }}</span>
                                </div>
                                <small class="text-muted">
                                    {{ activity.time.strftime('%d/%m/%Y %H:%M') }}
                                </small>
                            </div>
                        </div>
                        {% else %}
                        <div class="list-group-item">
                            <p class="text-muted mb-0">Aucune activité récente</p>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Scripts spécifiques au dashboard
    $(document).ready(function () {
        // Active le tooltip Bootstrap
        $('[data-toggle="tooltip"]').tooltip();

        // Animation des cartes de statistiques
        $('.stat-card').hover(
            function () {
                $(this).css('box-shadow', '0 5px 15px rgba(0,0,0,0.1)');
            },
            function () {
                $(this).css('box-shadow', 'none');
            }
        );
    });
</script>
{% endblock %}