{% extends "base.html" %}

{% block title %}Blog - Kaymay Services{% endblock %}

{% block extra_css %}
<style>
  .blog-page .blog-card {
    transition: transform 0.3s ease;
    margin-bottom: 30px;
    height: 100%;
  }
  .blog-page .blog-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.1);
  }
  .blog-page .card-img-top {
    height: 200px;
    object-fit: cover;
  }
  .blog-page .badge-category {
    position: absolute;
    top: 10px;
    right: 10px;
    background: rgba(0,0,0,0.7);
  }
  .blog-page .author-info img {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
  }
  .blog-page .pagination .page-item.active .page-link {
    background-color: #007bff;
    border-color: #007bff;
  }
</style>
{% endblock %}

{% block content %}
<section class="blog-page py-5">
  <div class="container">
    <!-- Page Header -->
    <div class="row mb-5">
      <div class="col-lg-10 mx-auto text-center">
        <h1 class="display-4 mb-3">Notre Blog</h1>
        <p class="lead">Découvrez les dernières actualités, conseils et réalisations de Kaymay Services</p>
        
        <!-- Search and Category Filter -->
        <div class="row mt-4">
          <div class="col-md-6 mx-auto">
            <form class="mb-4">
              <div class="input-group">
                <input type="text" class="form-control" placeholder="Rechercher un article...">
                <div class="input-group-append">
                  <button class="btn btn-primary" type="submit">
                    <i class="fa fa-search"></i>
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
        
        <!-- Category Filters -->
        <div class="category-filters mb-4">
          <a href="#" class="btn btn-outline-secondary active">Tous</a>
          <a href="#" class="btn btn-outline-secondary">Construction</a>
          <a href="#" class="btn btn-outline-secondary">Électricité</a>
          <a href="#" class="btn btn-outline-secondary">Maintenance</a>
          <a href="#" class="btn btn-outline-secondary">Innovations</a>
        </div>
      </div>
    </div>

    <!-- Featured Post (optional) -->
    {% if featured_post %}
    <div class="row mb-5">
      <div class="col-12">
        <div class="card border-0 shadow-lg">
          <div class="row no-gutters">
            <div class="col-md-6">
              <img src="{{ url_for('static', filename='uploads/blog/' + featured_post.image) }}" class="card-img h-100" alt="{{ featured_post.title }}">
            </div>
            <div class="col-md-6">
              <div class="card-body p-4">
                <div class="d-flex justify-content-between mb-2">
                  <span class="badge badge-primary">{{ featured_post.category }}</span>
                  <small class="text-muted">{{ featured_post.date_posted.strftime('%d %B %Y') }}</small>
                </div>
                <h2 class="card-title">{{ featured_post.title }}</h2>
                <p class="card-text">{{ featured_post.summary }}</p>
                <div class="d-flex align-items-center mt-4">
                  <img src="{{ url_for('static', filename='images/team/author.jpg') }}" class="mr-2" alt="Auteur">
                  <div>
                    <small class="d-block">Par {{ featured_post.author }}</small>
                    <small class="text-muted">5 min de lecture</small>
                  </div>
                </div>
                <a href="{{ url_for('views.blog_post', post_id=featured_post.id) }}" class="btn btn-primary mt-3">Lire l'article</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endif %}

    <!-- Blog Posts Grid -->
    <div class="row">
      {% for article in articles %}
      <div class="col-lg-4 col-md-6 mb-4">
        <div class="card blog-card h-100 shadow-sm">
          <div class="position-relative">
            <img src="{{ url_for('static', filename='uploads/blog/' + article.image) }}" class="card-img-top" alt="{{ article.title }}">
            <span class="badge badge-category text-white position-absolute">{{ article.category }}</span>
          </div>
          <div class="card-body">
            <div class="d-flex justify-content-between mb-2">
              <small class="text-muted">{{ article.date_posted.strftime('%d %B %Y') }}</small>
              <small class="text-muted"><i class="fa fa-eye mr-1"></i> {{ article.views }} vues</small>
            </div>
            <h5 class="card-title">{{ article.title }}</h5>
            <p class="card-text">{{ article.summary }}</p>
          </div>
          <div class="card-footer bg-white border-0">
            <div class="d-flex justify-content-between align-items-center">
              <a href="{{ url_for('views.blog_post', post_id=article.id) }}" class="btn btn-sm btn-outline-primary">Lire plus</a>
              <small class="text-muted">3 min de lecture</small>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>

    <!-- Pagination -->
    <nav aria-label="Page navigation" class="mt-5">
      <ul class="pagination justify-content-center">
      
        
       
      </ul>
    </nav>

    <!-- Newsletter Subscription -->
    <div class="row mt-5">
      <div class="col-lg-8 mx-auto">
        <div class="card bg-light border-0 p-4 text-center">
          <h3 class="mb-3">Abonnez-vous à notre newsletter</h3>
          <p class="mb-4">Recevez nos derniers articles et actualités directement dans votre boîte mail.</p>
          <form class="form-inline justify-content-center">
            <div class="input-group mb-2 mr-sm-2" style="width: 60%;">
              <input type="email" class="form-control" placeholder="Votre email">
              <div class="input-group-append">
                <button class="btn btn-primary" type="submit">S'abonner</button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
  // Animation au scroll
  document.addEventListener('DOMContentLoaded', function() {
    const blogCards = document.querySelectorAll('.blog-card');
    
    const animateOnScroll = function() {
      blogCards.forEach(card => {
        const cardPosition = card.getBoundingClientRect().top;
        const screenPosition = window.innerHeight / 1.3;
        
        if(cardPosition < screenPosition) {
          card.style.opacity = '1';
          card.style.transform = 'translateY(0)';
        }
      });
    };
    
    // Initial state
    blogCards.forEach(card => {
      card.style.opacity = '0';
      card.style.transform = 'translateY(20px)';
      card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
    });
    
    window.addEventListener('scroll', animateOnScroll);
    animateOnScroll(); // Trigger on load
  });
</script>
{% endblock %}